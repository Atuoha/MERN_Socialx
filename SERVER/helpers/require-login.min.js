'use strict';const jwt=require("jsonwebtoken"),{JWT_SECRET}=require("../config/jwt"),User=require("../model/User");module.exports=(c,d,e)=>{var {authorization:a}=c.headers;if(!a)return d.status(401).json({error:"Login to access feature"});a=a.replace("Bearer ","");jwt.verify(a,JWT_SECRET,(b,f)=>{if(b)return d.status(401).json({error:"Login to access feature"});({_id:b}=f);User.findById(b).then(g=>{c.user=g});e()})};